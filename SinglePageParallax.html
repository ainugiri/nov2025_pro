<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flat Parallax Time Cycle</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for smooth scrolling and fixed background */
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0F172A; /* Slate base color */
        }

        /* Fixed container that holds all moving elements (The Sky) */
        .parallax-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            pointer-events: none;
            transition: background 1.0s ease-out; /* Smoother transition for background changes */
        }

        /* Elements that move */
        .parallax-element {
            position: absolute;
            transition: opacity 0.5s ease-out, background-color 0.7s ease-out, transform 0.1s linear; /* Faster transform for immediate parallax */
        }

        /* Styling for the ground layers */
        .ground-layer {
            left: 0;
            width: 100%;
            position: absolute;
            transition: background-color 0.7s ease-out;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        /* Hide scrollbar for aesthetics, optional */
        body::-webkit-scrollbar {
            width: 0;
            background: transparent;
        }
        body {
            scrollbar-width: none;
        }

        /* Star twinkle remains for night effect */
        @keyframes twinkle {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .star {
            animation: twinkle 4s infinite ease-in-out alternate;
        }
    </style>
</head>
<body>

    <!-- The Scene Container: Fixed elements that move with parallax -->
    <div id="scene" class="parallax-container">
        
        <!-- Stars (Only visible at night) -->
        <div id="stars" class="parallax-element w-full h-full opacity-0">
            <div class="star absolute w-1 h-1 bg-white rounded-full" style="top: 5%; left: 10%;"></div>
            <div class="star absolute w-0.5 h-0.5 bg-white rounded-full animation-delay-200" style="top: 8%; left: 90%;"></div>
            <div class="star absolute w-1 h-1 bg-white rounded-full animation-delay-400" style="top: 20%; left: 45%;"></div>
            <div class="star absolute w-0.5 h-0.5 bg-white rounded-full animation-delay-600" style="top: 35%; left: 5%;"></div>
            <div class="star absolute w-1 h-1 bg-white rounded-full animation-delay-800" style="top: 55%; left: 70%;"></div>
            <div class="star absolute w-0.5 h-0.5 bg-white rounded-full" style="top: 70%; left: 25%;"></div>
            <div class="star absolute w-1 h-1 bg-white rounded-full animation-delay-200" style="top: 85%; left: 85%;"></div>
        </div>

        <!-- Sun (Starts at the top, moves down) -->
        <div id="sun" class="parallax-element w-24 h-24 md:w-32 md:h-32 rounded-full bg-yellow-300 shadow-2xl shadow-yellow-500/70" style="left: 50%; transform: translateX(-50%) translateY(0vh); top: 10vh;"></div>

        <!-- Moon (Starts hidden at the bottom, moves up) -->
        <div id="moon" class="parallax-element w-24 h-24 md:w-32 md:h-32 rounded-full bg-gray-100 shadow-xl shadow-gray-300/30" style="left: 50%; transform: translateX(-50%) translateY(100vh); top: 10vh; opacity: 0;">
            <!-- Crescent mask color will be updated in JS to match the current sky -->
            <div id="moon-mask" class="absolute w-full h-full rounded-full" style="box-shadow: 15px 0 0 0 #0F172A inset; left: -10px;"></div>
        </div>
        
        <!-- --- GROUND PARALLAX LAYERS (Closest to Farthest) --- -->

        <!-- Layer 3: Closest Ground (Fastest Movement - Largest block) -->
        <div id="ground-layer-3" class="ground-layer h-[30vh] bottom-0" style="transform: translateY(0vh);"></div>

        <!-- Layer 2: Mid Ground (Medium Movement) -->
        <div id="ground-layer-2" class="ground-layer h-[40vh] bottom-0" style="transform: translateY(0vh);"></div>

        <!-- Layer 1: Farthest Ground/Horizon (Slowest Movement - Smallest block) -->
        <div id="ground-layer-1" class="ground-layer h-[50vh] bottom-0" style="transform: translateY(0vh);"></div>
        
        <!-- Time of Day Text Indicator -->
        <div id="time-text" class="parallax-element text-center w-full top-1/2 left-0 -translate-y-1/2 text-white text-5xl md:text-9xl font-extrabold tracking-tight drop-shadow-lg" style="opacity: 1;">
            <span id="current-time">Morning</span>
        </div>
        
    </div>

    <!-- The Scroll Container: Provides the scrolling height -->
    <div id="scroll-content" class="min-h-[800vh] relative z-10">
        <!-- Content sections, spaced to mark transitions -->
        <div class="h-screen"></div>
        <div class="h-screen"></div>
        <div class="h-screen"></div>
        <div class="h-screen"></div>
        <div class="h-screen"></div>
        <div class="h-screen"></div>
        <div class="h-screen"></div>
        <div class="h-screen"></div>
    </div>

    <script>
        // Configuration variables 
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};

        const sun = document.getElementById('sun');
        const moon = document.getElementById('moon');
        const stars = document.getElementById('stars');
        const scene = document.getElementById('scene');
        const currentTimeSpan = document.getElementById('current-time');
        const moonMask = document.getElementById('moon-mask');
        
        // Ground layers
        const groundLayer1 = document.getElementById('ground-layer-1');
        const groundLayer2 = document.getElementById('ground-layer-2');
        const groundLayer3 = document.getElementById('ground-layer-3');


        // Color definitions for smooth transitions (Sky Gradients)
        const BG_COLORS = {
            MORNING: 'linear-gradient(to top, #7DD3FC 0%, #38BDF8 100%)', // Light Blue/Sky Blue
            AFTERNOON: 'linear-gradient(to top, #60A5FA 0%, #3B82F6 100%)', // Blue/Royal Blue
            EVENING: 'linear-gradient(to top, #F97316 0%, #EA580C 100%)', // Deep Orange/Red
            NIGHT: 'linear-gradient(to top, #6D28D9 0%, #370C78 100%)'    // Deep Purple/Violet
        };
        
        // Ground Layer Fill Colors (Flat colors for the blocks)
        const GROUND_FILL_COLORS = {
            LAYER3: { // Closest (moves fastest)
                MORNING: '#4ADE80', 
                AFTERNOON: '#16A34A',
                EVENING: '#78350F', 
                NIGHT: '#000000'
            },
            LAYER2: { // Mid
                MORNING: '#A7F3D0',
                AFTERNOON: '#065F46', 
                EVENING: '#43140C',
                NIGHT: '#171717'
            },
            LAYER1: { // Farthest (moves slowest - acts as distant horizon)
                MORNING: '#3B82F6', 
                AFTERNOON: '#1D4ED8',
                EVENING: '#6D28D9',
                NIGHT: '#262626'
            }
        };
        
        // Night Sky Color for Moon Mask (needs to match the BG)
        const NIGHT_SKY_COLOR = '#370C78';

        const TIME_LABELS = ['Morning', 'Afternoon', 'Evening', 'Night'];
        
        // Helper function for smoothly transitioning between values
        function lerp(start, end, t) {
            return start * (1 - t) + end * t;
        }

        function getColorKey(scrollPercent) {
            const currentQuadrant = Math.floor(scrollPercent * 4);
            return TIME_LABELS[Math.min(currentQuadrant, 3)].toUpperCase();
        }


        function updateScene() {
            const scrollPos = window.scrollY;
            const maxScroll = document.documentElement.scrollHeight - window.innerHeight;

            if (maxScroll === 0) return;

            const scrollPercent = scrollPos / maxScroll; // 0 to 1

            const timeKey = getColorKey(scrollPercent);

            // --- 1. Sun/Moon and Stars Movement ---

            let sunTranslateY, moonTranslateY, moonOpacity, starOpacity;

            // Sun Movement: Moves from 0vh down to 140vh
            sunTranslateY = lerp(0, 140, scrollPercent); 

            // Moon Movement: Rises from 100vh up to 10vh. Starts rising around 50% scroll.
            moonTranslateY = lerp(100, 10, Math.max(0, scrollPercent - 0.5) * 2);

            // Sun Opacity: Fades out completely by 60% scroll
            sun.style.opacity = Math.max(0, 1 - Math.pow(scrollPercent, 2) * 2.5);

            // Moon Opacity: Fades in starting at 40% scroll
            moon.style.opacity = Math.min(1, Math.max(0, scrollPercent * 2 - 0.8));
            
            // Star Opacity: Fades in sharply after 65% scroll
            starOpacity = Math.min(1, Math.max(0, scrollPercent * 3.5 - 2.275));
            stars.style.opacity = starOpacity;
            
            // Apply Sun/Moon Transforms
            sun.style.transform = `translateX(-50%) translateY(${sunTranslateY}vh)`;
            moon.style.transform = `translateX(-50%) translateY(${moonTranslateY}vh)`;
            
            // Update moon mask color to match the NIGHT_SKY_COLOR when stars are visible
            moonMask.style.boxShadow = `15px 0 0 0 ${starOpacity > 0.5 ? NIGHT_SKY_COLOR : '#0F172A'} inset`;
            

            // --- 2. Ground Parallax and Color ---
            
            // Parallax movement factors (how fast the ground moves up/down)
            const parallaxFactor1 = 10; // Farthest/Slowest
            const parallaxFactor2 = 20; // Mid
            const parallaxFactor3 = 30; // Closest/Fastest
            
            // Apply vertical translation (The ground moves up slightly as we scroll down)
            groundLayer1.style.transform = `translateY(${-scrollPercent * parallaxFactor1}vh)`;
            groundLayer2.style.transform = `translateY(${-scrollPercent * parallaxFactor2}vh)`;
            groundLayer3.style.transform = `translateY(${-scrollPercent * parallaxFactor3}vh)`; 

            // Update Ground Layer Fill Colors based on timeKey
            groundLayer1.style.backgroundColor = GROUND_FILL_COLORS.LAYER1[timeKey];
            groundLayer2.style.backgroundColor = GROUND_FILL_COLORS.LAYER2[timeKey];
            groundLayer3.style.backgroundColor = GROUND_FILL_COLORS.LAYER3[timeKey];
            
            // --- 3. Background and Text Updates ---

            // Set background gradient based on current time key
            scene.style.background = BG_COLORS[timeKey];

            // Update text indicator
            currentTimeSpan.textContent = timeKey.charAt(0) + timeKey.slice(1).toLowerCase(); // Capitalize first letter only
            
            // Text opacity for the main indicator
            const currentQuadrant = Math.floor(scrollPercent * 4);
            const textOpacity = 1 - (Math.abs(scrollPercent - (currentQuadrant * 0.25 + 0.125)) / 0.125) * 0.4;
            timeText.style.opacity = Math.max(0.6, textOpacity);
        }

        // Initialize and bind the scroll listener
        window.addEventListener('scroll', updateScene);
        window.addEventListener('load', () => {
            // Run once on load to set initial state
            updateScene();
        });

        // Set up dummy animation delay for stars
        const starElements = document.querySelectorAll('.star');
        starElements.forEach((star, index) => {
            star.style.animationDelay = `${index * 0.5}s`;
        });
        
        // No clouds in this minimalist design, so removing cloud logic
    </script>
</body>
</html>